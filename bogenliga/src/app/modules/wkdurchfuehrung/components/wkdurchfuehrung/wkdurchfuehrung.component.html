<bla-common-dialog [config]="config">
  <div (mouseover)="onMouseOver($event)">
    <bla-hilfe-button href="https://wiki.bsapp.de/doku.php?id=liga:wettkampfdurchfuehrung"
                      target="_blank"></bla-hilfe-button>

    <p class="subtitle">{{'WKDURCHFUEHRUNG.WKDURCHFUEHRUNG.DESCRIPTION' | translate}}</p>
    <div class="layout-elements">
      <bla-col-layout>

        <div class="flexChild">
          <h2><a class="blackLink"
                 routerLink="/wkdurchfuehrung">{{ 'WKDURCHFUEHRUNG.TITEL.VERANSTALTUNG' | translate }}</a></h2>

          <div id="dropDownMenuYear"
               style="width: 80%; margin-bottom: 2%;">
            <bla-dropdown-menu (onSelect)="onSelectYear($event)"
                               [id]="'Veranstaltungen-dropdown-menu'"
                               [items]="availableYears"
                               [optionFieldSelector]="'sportjahr'"
                               [loading]="loadingYears"
                               [selectedItemId]='selItemId'
                               [disabled]="isOfflineDisabled()"
                               data-cy="wkduchfuehrung-jahr-dropdown"
                               style="width: 40%;">
            </bla-dropdown-menu>

          </div>

          <table id="example"
                 class="table table-hover table-sm table-responsive-sm thead-light table-striped"
                 style="width:80%">
            <!-- headlines -->


            <bla-quicksearch-list (onSelect)="onSelect($event)"
                                  [items]="veranstaltungen"
                                  [loading]="loadingVeranstaltungen"
                                  [multipleSelections]="!multipleSelections"
                                  [placeholderTranslationKey]="PLACEHOLDER_VAR"
                                  [optionFieldSelector]="'name'"
                                  [disabled]="isOfflineDisabled()"
                                  selectionListHeight="15em"
                                  data-cy="wkduchfuehrung-veranstaltung-list"
                                  style="width: 40%; flex-grow: 0;">
            </bla-quicksearch-list>

          </table>

        </div>


        <div>
          <h2>
            {{'WKDURCHFUEHRUNG.TITEL.WKTAG' | translate }}
          </h2>

          <div class="row">
            <section class="overview-dialog-content">

              <bla-data-table [config]="config_table"
                              [rows]="rows"
                              [loading]="loadingWettkampfe"
                              data-cy="wkdurchfuehrung-wettkampftage-list"
                              (onViewEntry)="onView($event)"
                              (onMapEntry)="onMap($event)">

              </bla-data-table>

              <bla-teilnemende-manschaften-tabelle [veranstaltungsId]="selectedVeranstaltungId">
              </bla-teilnemende-manschaften-tabelle>
            </section>


            <!-- Dies ist die Liste der Wettkampftage zur Veranstaltung  -->

          </div>
        </div>
      </bla-col-layout>

      <bla-col-layout>
        <h2 id="WettkampfTitle"></h2>
      </bla-col-layout>

      <bla-col-layout>
        <div>
          <BR>
          <h2>{{'MANNSCHAFTEN.LIGATABELLE.LIGATABELLE_VORBEREITUNG'|translate}}</h2>
          <p>{{'MANNSCHAFTEN.LIGATABELLE.TEXT'|translate}}</p></div>
      </bla-col-layout>

      <bla-col-layout [style]="'flex-wrap: wrap'">

        <bla-actionbutton
          [id]="'generiereMatches'"
          [disabled]="isDisabledGMButton()"
          [color]="ActionButtonColors.PRIMARY"
          [iconClass]="'cogs'"
          (onClick)="generateMatches()">
          {{ 'WKDURCHFUEHRUNG.BUTTON.MATCHES' | translate }}
        </bla-actionbutton>


          <bla-download-actionbutton
            [id]="'downloadSetzliste'"
            [downloadUrl]="onButtonDownload('pdf/setzliste')"
            [fileName]="'setzliste.pdf'"
            [color]="ActionButtonColors.PRIMARY"
            [iconClass]="'file-download'"
            [disabled]="isDisabled()">{{ 'WKDURCHFUEHRUNG.BUTTON.SETZLISTE' | translate }}

          </bla-download-actionbutton>

          <bla-download-actionbutton
            [id]="'downloadSchusszettel'"
            [downloadUrl]="onButtonDownload('pdf/schusszettel')"
            [fileName]="'schusszettel.pdf'"
            [color]="ActionButtonColors.PRIMARY"
            [iconClass]="'file-download'"
            [disabled]="isDisabled()">{{ 'WKDURCHFUEHRUNG.BUTTON.SCHUSSZETTEL' | translate }}

          </bla-download-actionbutton>

          <bla-download-actionbutton
            [id]="'downloadBogenkontrollliste'"
            [downloadUrl]="onButtonDownload('pdf/bogenkontrollliste')"
            [fileName]="'bogenkontrollliste.pdf'"
            [disabled]="isDisabled()"
            [color]="ActionButtonColors.PRIMARY"
            [iconClass]="'file-download'">
            {{ 'WKDURCHFUEHRUNG.BUTTON.KONTROLLLISTE' | translate }}
          </bla-download-actionbutton>

          <bla-download-actionbutton
            [id]="'downloadMeldezettel'"
            [downloadUrl]="onButtonDownload('pdf/meldezettel')"
            [fileName]="'meldezettel.pdf'"
            [color]="ActionButtonColors.PRIMARY"
            [iconClass]="'file-download'"
            [disabled]="isDisabled()">{{ 'WKDURCHFUEHRUNG.BUTTON.MELDEZETTEL' | translate }}

          </bla-download-actionbutton>

        <div id="setupTable"
             *ngIf="(!isOffline()); else onlineSetupTables">
          <bla-actionbutton (click)="onButtonTabletClick()"
                            [color]="ActionButtonColors.PRIMARY"
                            [iconClass]="'table'"
                            [disabled]="isDisabled()">{{ 'WKDURCHFUEHRUNG.BUTTON.TABLE_SETUP' | translate }}
          </bla-actionbutton>
        </div>

          <bla-actionbutton
            [id]="'DSB-Mitglied anlegen'"
            [color]="ActionButtonColors.PRIMARY"
            [iconClass]="'user-plus'"
            (onClick)="addDSBMitglied()">
            {{ 'WKDURCHFUEHRUNG.BUTTON.MITGLIED_ANLEGEN' | translate }}
          </bla-actionbutton>

        <ng-template #onlineSetupTables
                     id="onlineSetupTables">
          <div>
            <bla-actionbutton (click)="onButtonTabletClick()"
                              [color]="ActionButtonColors.PRIMARY"
                              [iconClass]="'table'"
                              [disabled]="true">{{ 'WKDURCHFUEHRUNG.BUTTON.TABLE_SETUP' | translate }}
            </bla-actionbutton>
          </div>
        </ng-template>


        <div id="offlineButton"
             *ngIf="(!isOffline()); else backOnline ">
          <bla-actionbutton (click)="onButtonGoOfflineClick()"
                            [color]="ActionButtonColors.DANGER"
                            [iconClass]="'power-off'"
                            [disabled]="isDisabled()"
                            data-cy="wkdurchfuehrung-btn-offlinegehen">{{ 'WKDURCHFUEHRUNG.BUTTON.OFFLINE_GEHEN' | translate }}
          </bla-actionbutton>
        </div>

        <ng-template #backOnline
                     id="onlineButton">
          <div>
            <bla-actionbutton (click)="onButtonGoOfflineClick()"
                              [color]="ActionButtonColors.SUCCESS"
                              [iconClass]="'cloud'"
                              [disabled]="isDisabled()">{{ 'WKDURCHFUEHRUNG.BUTTON.ONLINE_GEHEN' | translate }}
            </bla-actionbutton>
          </div>
        </ng-template>

        <div id="adminOfflineResetButton"
             *ngIf="(isAdmin())">
          <bla-actionbutton (click)="resetWettkampfToken(this.selectedWettkampfId)"
                            [color]="ActionButtonColors.DANGER"
                            [iconClass]="'trash'"
                            [disabled]="isDisabled()">{{ 'WKDURCHFUEHRUNG.BUTTON.OFFLINE_TOKEN' | translate }}
          </bla-actionbutton>
        </div>

      </bla-col-layout>


      <bla-col-layout>
        <BR>
        <h2><BR>{{ 'WKDURCHFUEHRUNG.TITEL.LT_DURCHFUEHRUNG' | translate }} <BR>&nbsp;</h2>
        <BR>

      </bla-col-layout>

      <bla-col-layout>


        <div class="row"
             style="margin-left: 5px">
          <section class="overview-dialog-content">

            <bla-data-table [config]="config_table_match"
                            [rows]="matchRows"
                            [loading]="loadingMatch"
                            data-cy="wkdurchfuehrung-match-list"
                            (onEditEntry)="onEdit($event)">

            </bla-data-table>
          </section>

        </div>

      </bla-col-layout>


      <router-outlet></router-outlet>

    </div>
  </div>
</bla-common-dialog>
